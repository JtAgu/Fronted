<!DOCTYPE html>
<html lang="en">
<head>
	<title>Crear Paciente</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor2/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts2/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts2/iconic/css/material-design-iconic-font.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor2/animate/animate.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="vendor2/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor2/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor2/select2/select2.min.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="vendor2/daterangepicker/daterangepicker.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css2/util.css">
	<link rel="stylesheet" type="text/css" href="css2/main.css">
<!--===============================================================================================-->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
<!--===============================================================================================-->
</head>
<body>
	
	<div class="limiter">
		<div class="container-login100" style="background-image: url('images/bg-01.jpg');">
			<div class="wrap-login100 p-l-55 p-r-55 p-t-65 p-b-54">
				<form class="login100-form validate-form">
					<span class="login100-form-title p-b-49">
						REGISTRO DE PACIENTES
					</span>

					<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
						<span class="label-input100">Nombre</span>
						<input class="input100" type="text" name="username" placeholder="Escribe tu Nombre" id="nombre" required>
						<span class="focus-input100" data-symbol="&#xf206;"></span>
					</div>

					<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
						<span class="label-input100">Apellido</span>
						<input class="input100" type="text" name="username" placeholder="Escribe tu Apellido" id="apellido" required>
						<span class="focus-input100" data-symbol="&#xf206;"></span>
					</div>



					<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
						<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
							<span class="label-input100">Fecha de Nacimiento</span>
							<input type="date" id="start" name="trip-start"
							 value="2018-07-22"
							 min="1960-01-01" max="2015-12-12">
							 <br>
						</div>
					</div>
					
					<span class="label-input100">Genero</span>
					<br>
					<div class="btn-group" role="group" aria-label="Basic radio toggle button group">
						
						<input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
						<label class="btn btn-outline-primary" for="btnradio1">Femenino</label>
					  
						<input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
						<label class="btn btn-outline-primary" for="btnradio2">Masculino</label>
					  </div>
					  <br><br>


					<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
						<span class="label-input100">Nombre de Usuario</span>
						<input class="input100" type="text" name="username" placeholder="Escribe tu nombre de usurario" id="NombreUsuario" required>
						<span class="focus-input100" data-symbol="&#xf206;"></span>
					</div>

					<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
						<span class="label-input100">Contraseña</span>
						<input class="input100" type="text" name="username" placeholder="Escribe tu contraseña" id="Contra" required>
						<span class="focus-input100" data-symbol="&#xf206;"></span>
					</div>

					<div class="wrap-input100 validate-input m-b-23" data-validate = "Username is reauired">
						<span class="label-input100">Telefono</span>
						<input class="input100" type="text" name="username" placeholder="Escribe tu Telefono" id="Telefono" required>
						<span class="focus-input100" data-symbol="&#xf206;"></span>
					</div>
					
					
					<div class="container-login100-form-btn">
						<div class="wrap-login100-form-btn">
							<div class="login100-form-bgbtn"></div>
							<button class="login100-form-btn" onclick="ObtenerDatos()" type="button" class="btn btn-outline-dark" >
							Crear Usuario	
							</button>
						</div>
					</div>
					<br>
					<div class="container-login100-form-btn">
						<div class="wrap-login100-form-btn">
							<div class="login100-form-bgbtn"></div>
							<button class="login100-form-btn" onclick="Volver()" type="button" class="btn btn-outline-dark" >
							Salir	
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
	

	<div id="dropDownSelect1"></div>
	
<!--===============================================================================================-->
	<script src="vendor2/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor2/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor2/bootstrap/js/popper.js"></script>
	<script src="vendor2/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor2/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor2/daterangepicker/moment.min.js"></script>
	<script src="vendor2/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="vendor2/countdowntime/countdowntime.js"></script>
<!--===============================================================================================-->
	<script src="js2/main.js"></script>
<!--===============================================================================================-->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>    
<!--===============================================================================================-->
<script>
	function NuevoUsuario(){
		var nombre = document.querySelector('#nombre').value
		var apellido = document.querySelector('#apellido').value
		var rd1=document.getElementById("btnradio2").checked;
		var rd2=document.getElementById("btnradio1").checked;
		var Gen
		if(rd1){
			Gen ="M"
			console.log(Gen)
		}else{
			Gen ="F"
			console.log(Gen)
		}
		var Fecha=document.getElementById("start").value;
		console.log(Fecha)
		var NomUsu=document.querySelector('#NombreUsuario').value
		var Contra=document.querySelector('#Contra').value
		var Telefono=document.querySelector('#Telefono').value
		// CREANDO NUESTRO JSON
		if(Contra.length>7){
			var objeto = {
			'nombre':nombre,
			'apellido':apellido,
			'edad':Fecha,
			'sexo':Gen,
			'nombreUsuario':NomUsu,
			'contra':Contra,
			'tele':Telefono
		}
		console.log(objeto)

		// EL METODO MAGICO - EL FETCH
		
		fetch('https://backend--jt.herokuapp.com/Pacientes', {
		method: 'POST',
		body: JSON.stringify(objeto),
		headers:{
			'Content-Type': 'application/json',
			'Access-Control-Allow-Origin': '*',}})
		.then(res => res.json())
		.catch(err => {
			console.error('Error:', err)
			alert("Ocurrio un error, ver la consola")
		})

		.then(response =>{
			console.log(response);
			alert(response.Mensaje)
		})
		}else{
			alert("Contraseña demasiado corta")
			Volver()
		}
		
	}
	function Volver(){
		location.href="LogIn.html"
	}

	function ObtenerDatos(){
		  var nombre = document.querySelector('#NombreUsuario').value
			fetch(`https://backend--jt.herokuapp.com/Paciente/${nombre}`,{
			  method: 'GET',
			  headers:{
				  'Content-Type': 'application/json',
				  'Access-Control-Allow-Origin': '*',}})
			  .then(res => res.json())
			  .catch(err => {
				  console.error('Error:', err)
				  alert("Ocurrio un error, ver la consola")
			  })
			  .then(response =>{
				if(response.Mensaje=="Si"){
					alert("Nombre usuario ya existente")
				}else{
				 ObtenerEnfermera() 
				} 
			  })
		  }



		  function ObtenerEnfermera(){
		  var nombre = document.querySelector('#NombreUsuario').value
			fetch(`https://backend--jt.herokuapp.com/Enfermera/${nombre}`,{
			  method: 'GET',
			  headers:{
				  'Content-Type': 'application/json',
				  'Access-Control-Allow-Origin': '*',}})
			  .then(res => res.json())
			  .catch(err => {
				  console.error('Error:', err)
				  alert("Ocurrio un error, ver la consola")
			  })
			  .then(response =>{
				if(response.Mensaje=="Si"){
					alert("Nombre usuario ya existente")
				}else{
					ObtenerDoc()
				}
				
			  })
		  }
		  function ObtenerDoc(){
		  var nombre = document.querySelector('#NombreUsuario').value
			fetch(`https://backend--jt.herokuapp.com/Doctor/${nombre}`,{
			  method: 'GET',
			  headers:{
				  'Content-Type': 'application/json',
				  'Access-Control-Allow-Origin': '*',}})
			  .then(res => res.json())
			  .catch(err => {
				  console.error('Error:', err)
				  alert("Ocurrio un error, ver la consola")
			  })
			  .then(response =>{
				if(response.Mensaje=="Si"){
					alert("Nombre usuario ya existente")
				}else{
					NuevoUsuario()
				}
  
			  })
		  }

</script>
</body>
</html>